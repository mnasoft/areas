(let*
    ((AB 5053.0)
     (AC 263.5)
     (AG 75.0)
     (AH 31.8)
     (AF 618.4)
     (BC 651.0)
     (BD 1950.5)
     (BE 5447.0)
     (CG 1400.3)
     (DF 589.0)
     (EF 9881.0)
     (GF 1867.0)
     (FH 10760.0)
     (X1 (f_ek (list (+ AB (f_ek (list (+ AC(f_ek (list AG CG))) BC))) BE EF FH)))
     (X2 (f_ek (list (+ AB (f_ek (list (+ AC(f_ek (list AG CG))) BC))) BD DF FH)))
     (X3 (f_ek (list GF FH (+ AG (f_ek (list CG (+ AC (f_ek (list AB BC)))))))))
     (X4 (+ AH (f_ek (list AF FH))))
     (SUMM_X (+ X1 X2 X3 X4))
     (_X1 (/ X1 SUMM_X))
     (_X2 (/ X2 SUMM_X))
     (_X3 (/ X3 SUMM_X))
     (_X4 (/ X4 SUMM_X))
     )
  (list _X1 _X2 _X3 _X4)
  )

(defun a_by_seq(seq)
  (let ((aa (mapcar #'(lambda(el)(cons (third el) (second el))) agt))
	(summ 0.0))
    (mapc #'(lambda(el)
	      (if (equal seq (car el))
		  (setf summ (+ summ (cdr el)))))
	  aa)
    summ))

(mapcar
 #'(lambda (el)
     (list el (a_by_seq el)))
 '(AB AC AG AH AF BC BD BE CG DF EF GF FH))


(a_by_seq 'AB)
  
(mapcar #'(lambda(el)(cons (third el) (second el))) agt)

(defparameter agt
  '((d1 589.0 DF)
    (d2 374.6 AB)
    (d3 388.8 AB)
    (d4 424.1 AB)
    (d5 424.1 AB)
    (d6 424.1 AB)
    (d7 424.1 AB)
    (d8 424.1 AB)
    (d9 424.1 AB)
    (d10 294.5 AB)
    (d11 294.5 AB)
    (d12 294.5 AB)
    (d13 294.5 AB)
    (d14 294.5 AB)
    (d15 188.5 AB)
    (d16 188.5 AC)
    (d17 150.8 AF)
    (d18 103.9 AF)
    (d19 35.3 AF)
    (d20 35.3 AF)
    (d21 87.1 AF)
    (d22 124.8 AF)
    (d22_ 51.2 AF)
    (d23 31.8 AH) ;;;;
    (d23_ 30.0 AF)
    (F1 9881.0 EF)
    (F2 1950.5 BD)
    (F3 5447.0 BE)
    (F4 651.0 BC)
    (F5 84.0 AB)
    (F6 75.0 AC)
    (F7 1400.3 CG)
    (F8 75.0 AG)
    (F9 1867.0 GF)
    (F10 10760.0 FH)))

(mapcar #'(lambda (el)
	(list (car el) (car(last el))))
	'(
	  (AB d2 d3 d4 d5 d6 d7 d8 d9 d10 d11 d12 d13 d14 d15 F5 5053.0)
	  (AC d16 F6 263.5)
	  (AG F8 75)
	  (AH d23 31.8)
	  (AF d17 d18 d19 d20 d21 d22 d22_ d23_ 618.4)
	  (BC F4 651)
	  (BD F2 1950.5)
	  (BE F3 5447)
	  (CG F7 1400.3)
	  (GF F9 1867)
	  (FH F10 10760)
	  (AB_ d5 95.03)
	  (AC_ F1 595.2)
	  (AD_ d10 402.12)
	  (DG_ d15 212.06)
	  (EE_ F3 4623.00)
	  (B_F d6 d7 d8 d9 33.02)
	  (C_F F2 337.28)
	  (D_F_ d11 d12 d13 72.38)
	  (E_F F4 4736.73)
	  (F_F F14 81.45)
	  (G_F d16 53.01)))

(let*
    ((AB 5053.0)
     (AC 263.5)
     (AG 75)
     (AH 31.8)
     (AF 618.4)
     (BC 651)
     (BD 1950.5)
     (BE 5447)
     (CG 1400.3)
     (GF 1867)
     (FH 10760)
     (AB_ 95.03)
     (AC_ 595.2)
     (AD_ 402.12)
     (DG_ 212.06)
     (EE_ 4623.0)
     (B_F 33.02)
     (C_F 337.28)
     (D_F_ 72.38)
     (E_F 4736.73)
     (F_F 81.45)
     (G_F 53.01)
     (X1 (f_ek (+ (f_ek  AD_ D_F_ F_F)
		  (f_ek AC_ C_F)
		  (f_ek  AB_ B_F))
	       FH))
     (X2 (f_ek 	(+ AB (f_ek BC (+ AC (f_ek AG CG))))
		(+ (f_ek BD DG_ G_F)
		   (f_ek  BE EE_ E_F))
		FH))
     (X3 (f_ek (+ AG (f_ek CG
			   (+ AC
			      (f_ek AB BC))))
	       GF
	       FH))
     (X4 (+ AH (f_ek AF FH)))
     (SUMM_X (+ X1 X2 X3 X4))
     (_X1 (/ X1 SUMM_X))
     (_X2 (/ X2 SUMM_X))
     (_X3 (/ X3 SUMM_X))
     (_X4 (/ X4 SUMM_X))
     )
  (values 
   (apply #'+(list X1 X2 X3 X4))
   (apply #'f_otn (list X1 X2 X3 X4)))
  )

